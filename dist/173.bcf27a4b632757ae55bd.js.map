{"version":3,"file":"173.bcf27a4b632757ae55bd.js","mappings":"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","sources":["./src/app/pages/company/pages/update-product/services/index.ts","./src/app/pages/company/pages/update-product/services/mapper/mapper.service.ts","./src/app/pages/company/pages/update-product/update-product-routing.module.ts","./src/app/pages/company/pages/update-product/update-product.component.ts","./src/app/pages/company/pages/update-product/update-product.component.html","./src/app/pages/company/pages/update-product/update-product.module.ts","./src/app/pages/company/store/form/form.models.ts","./src/app/pages/company/store/form/form.selectors.ts","./src/app/pages/company/store/form/index.ts"],"sourcesContent":["export * from './mapper/mapper.service';\r\n","import { Injectable } from \"@angular/core\";\r\nimport { ProductForm } from \"@app/pages/company/store/form\";\r\nimport {ProductResponse} from '@app/pages/company/store/save';\r\n\r\n@Injectable()\r\nexport class MapperService{\r\n  constructor(){}\r\n\r\n  productToForm(product: ProductResponse) : ProductForm {\r\n\r\n    const productForm : ProductForm = {\r\n      nombre: product.nombre,\r\n      descripcion: product.descripcion,\r\n      photoURL : product.imagen,\r\n      categoria: product.categoriaId,\r\n      marca: product.marcaId,\r\n      precio: product.precio,\r\n      stock: product.stock\r\n    }\r\n\r\n    return productForm;\r\n  }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { UpdateProductComponent } from './update-product.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: UpdateProductComponent\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class UpdateProductRoutingModule { }\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { Observable } from 'rxjs';\nimport * as fromDictionaries from '@app/store/dictionaries';\nimport * as fromRoot from '@app/store';\nimport * as fromList from '../../store/save';\nimport * as fromForm from '../../store/form';\nimport { ControlItem } from '@app/models/frontend';\nimport { ControlEntities } from '@app/shared/utils/form';\nimport { select, Store } from '@ngrx/store';\nimport { regex, regexErrors, markFormGroupTouched } from '@app/shared/utils';\nimport { ActivatedRoute, Params } from '@angular/router';\nimport { MapperService } from './services';\n\nexport interface ProductForm{\n  nombre: string | null;\n  descripcion: string | null;\n  stock: number | null;\n  precio: number | null;\n  categoria: number | null;\n  marca: number | null;\n  photoURL : string | null;\n}\n\n\n@Component({\n  selector: 'app-update-product',\n  templateUrl: './update-product.component.html',\n  styleUrls: ['./update-product.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class UpdateProductComponent implements OnInit {\n  loading$ !: Observable<boolean | null>;\n  form !: FormGroup;\n  dictionaries$ !: Observable<fromDictionaries.Dictionaries>;\n  categories !: ControlItem[];\n  marca !: ControlItem[];\n  controls !: ControlEntities;\n  regexErrors = regexErrors;\n\n  constructor(\n    private store: Store<fromRoot.State>,\n    private fb: FormBuilder,\n    private router: ActivatedRoute,\n    private mapperService: MapperService,\n    private cdr : ChangeDetectorRef\n  ) { }\n\n  ngOnInit(): void {\n\n    this.loading$ = this.store.pipe(select(fromList.getLoading));\n\n    this.store.pipe(select(fromDictionaries.getDictionaries))\n      .subscribe((data: any) => {\n        if (data) {\n          this.categories = data.categories.controlItems as ControlItem[];\n          this.marca = data.marca.controlItems as ControlItem[];\n\n          this.controls = {\n            categoria: {\n              items: this.categories,\n              changed: () => { }\n            },\n            marca: {\n              items: this.marca,\n              changed: () => { }\n            },\n          }\n        }\n      });\n\n\n\n    this.form = this.fb.group({\n      nombre: [null, {\n        updateOn: 'blur', validators: [\n          Validators.required\n        ]\n      }],\n\n      descripcion: [null, {\n        updateOn: 'blur', validators: [\n          Validators.required\n        ]\n      }],\n\n\n      stock: [null, {\n        updateOn: 'blur', validators: [\n          Validators.required,\n          Validators.pattern(regex.number)\n        ]\n      }],\n\n\n      precio: [null, {\n        updateOn: 'blur', validators: [\n          Validators.required,\n          Validators.pattern(regex.number)\n        ]\n      }],\n\n      photoURL: [null],\n      categoria: null,\n      marca: null\n    })\n\n\n    this.controls = {\n      categoria: {\n        items: this.categories,\n        changed: () => { }\n      },\n      marca: {\n        items: this.marca,\n        changed: () => { }\n      },\n    }\n\n\n\n    this.store.pipe(select(fromForm.getFormState))\n    .subscribe(productForm => {\n        if(productForm.nombre){\n           const value = productForm;\n           this.form.patchValue(value);\n           this.form.updateValueAndValidity();\n           this.cdr.detectChanges();\n        }\n    });\n\n    // leer la data del producto que esta en formato ProductResponse -> Store Redux\n    // Vuelve a setearlo al Store Redux ---> ProductForm\n    this.store.pipe(select(fromList.getProduct))\n    .subscribe(product => {\n      if(product){\n        const form  = this.mapperService.productToForm(product);\n        this.store.dispatch(new fromForm.Set(form));\n      }\n    })\n\n    this.router.params.subscribe( (param: Params) => {\n      const id = param.id;\n      this.store.dispatch(new fromList.Read(id));\n    })\n\n\n\n\n\n  }\n\n  onSubmit() : void {\n\n    if(this.form.valid){\n      this.loading$ = this.store.pipe(select(fromList.getLoading));\n\n      this.router.params.subscribe( (param: Params) => {\n        const value = this.form.value;\n        const product : fromList.ProductUpdateRequest = {\n          id : param.id,\n          nombre : value.nombre,\n          descripcion: value.descripcion,\n          categoriaId : value.categoria,\n          marcaId: value.marca,\n          precio: value.precio,\n          stock: value.stock,\n          imagen: value.photoURL\n        }\n\n        const id = param.id;\n\n\n        this.store.dispatch(new fromList.Update(id, product));\n\n      })\n    }else{\n      markFormGroupTouched(this.form);\n    }\n  }\n\n\n  onFilesChanged(url: any) : void {\n    if(url){\n      this.form.controls.photoURL.setValue(url);\n    }\n  }\n\n\n\n\n}\n","<div class=\"app-page\">\n\n  <div class=\"app-page__header\">\n    <h1>Editar Producto</h1>\n  </div>\n\n  <form [formGroup]=\"form\" autocomplete=\"off\" (submit)=\"onSubmit()\">\n\n\n    <div class=\"app-page__content\">\n\n        <div class=\"personal__photo\">\n          <div class=\"photo\">\n            <app-user-photo class=\"photo__img\" [photoURL]=\"form.controls.photoURL.value\" ></app-user-photo>\n             <div class=\"app-a\" appFilesUpload (changed)=\"onFilesChanged($event)\">\n                Subir Imagen\n             </div>\n          </div>\n        </div>\n\n        <app-form-field label=\"Nombre\" [required]=\"true\" [control]=\"form.controls.nombre\" [isInline]=\"false\">\n            <app-input formControlName=\"nombre\"></app-input>\n        </app-form-field>\n\n        <app-form-field label=\"Descripcion\" [required]=\"true\" [control]=\"form.controls.descripcion\" [isInline]=\"false\">\n          <app-input formControlName=\"descripcion\"></app-input>\n        </app-form-field>\n\n\n        <app-form-field label=\"Stock\" [required]=\"true\" [control]=\"form.controls.stock\" [isInline]=\"false\"\n          [patternError]=\"regexErrors.number\"\n        >\n          <app-input formControlName=\"stock\"></app-input>\n        </app-form-field>\n\n\n        <app-form-field label=\"Precio\" [required]=\"true\" [control]=\"form.controls.precio\" [isInline]=\"false\"\n          [patternError]=\"regexErrors.number\"\n        >\n          <app-input formControlName=\"precio\"></app-input>\n        </app-form-field>\n\n\n        <app-form-field label=\"Categoria\" [required]=\"true\" [control]=\"form.controls.categoria\" [isInline]=\"false\">\n\n          <app-select formControlName=\"categoria\" [items]=\"controls.categoria.items ? controls.categoria.items : []\" ></app-select>\n\n        </app-form-field>\n\n        <app-form-field label=\"Marca\" [required]=\"true\" [control]=\"form.controls.marca\" [isInline]=\"false\">\n\n          <app-select formControlName=\"marca\" [items]=\"controls.marca.items ? controls.marca.items : []\" ></app-select>\n\n        </app-form-field>\n\n    </div>\n\n\n    <div class=\"app-page__footer\">\n      <app-button type=\"submit\" >Guardar</app-button>\n    </div>\n\n\n  </form>\n\n  <app-spinner *ngIf=\"loading$ | async\"></app-spinner>\n\n\n\n</div>\n\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { UpdateProductRoutingModule } from './update-product-routing.module';\nimport { UpdateProductComponent } from './update-product.component';\n\nimport { RouterModule } from '@angular/router';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { FormFieldModule, InputModule,SelectModule } from '@app/shared/controls';\nimport { ButtonModule } from '@app/shared/buttons';\nimport { SpinnerModule } from '@app/shared/indicators';\nimport { PopupsModule, UserPhotoModule } from '@app/shared';\nimport { MapperService } from './services';\n\n\n@NgModule({\n  declarations: [\n    UpdateProductComponent\n  ],\n  imports: [\n    CommonModule,\n    UpdateProductRoutingModule,\n    RouterModule,\n    ReactiveFormsModule,\n    FormFieldModule,\n    InputModule,\n    ButtonModule,\n    SpinnerModule,\n    PopupsModule,\n    UserPhotoModule,\n    SelectModule\n  ],\n  providers: [\n    MapperService\n  ]\n\n})\nexport class UpdateProductModule { }\n","\r\nexport {ProductForm} from '../../pages/update-product/update-product.component';\r\n","\r\nimport {createSelector} from '@ngrx/store';\r\nimport {getProductState, ProductState} from '../index';\r\n\r\nexport const getFormState = createSelector(\r\n  getProductState,\r\n  (state: ProductState) => state.form\r\n)\r\n","\r\nexport * from './form.actions';\r\nexport * from './form.reducer';\r\nexport * from './form.selectors';\r\nexport * from './form.models';\r\n\r\n"],"names":[],"sourceRoot":"webpack:///"}